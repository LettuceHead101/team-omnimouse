# OmniMouse

OmniMouse is a WPF application for Windows (.NET 8) that enables real-time sharing and monitoring of mouse and keyboard input between two computers over a network. It can operate in either "Host" or "Cohost" mode, allowing one machine to remotely inject and mirror input events from another. All input activity and system messages are displayed in a live log within the application's main window.

---

## Features

- **Global Mouse & Keyboard Hooking:** Captures all mouse and keyboard events system-wide.
- **Networked Input Sharing:** Sends and receives mouse position data over UDP.
- **Host/Cohost Modes:**  
  - **Host:** Listens for incoming mouse position packets and injects them locally.
  - **Cohost:** Sends local mouse position to a specified host IP.
- **Live Log UI:** All input events and system messages are displayed in a scrollable, styled log window.
- **WPF UI:** Modern, responsive interface with clear controls for mode selection.

---

## How It Works

1. **Startup:**  
   The app displays two buttons: **Host** and **Cohost**.  
   - In **Host** mode, the app listens for UDP packets and injects received mouse positions.
   - In **Cohost** mode, the app sends local mouse positions to the specified host IP.

2. **Input Hooks:**  
   Low-level Windows hooks capture mouse and keyboard events.  
   - All events are logged to the UI.
   - Mouse movements are sent over the network in Cohost mode.

3. **Network Communication:**  
   UDP is used for fast, connectionless transmission of mouse data.

4. **UI Log:**  
   All `Console.WriteLine` output (from hooks, network, or anywhere in the app) is redirected to the main window's log box.

---

## File Overview

| File                                 | Purpose/Goal                                      | Used by/with                |
|-------------------------------------- |---------------------------------------------------|-----------------------------|
| **App.xaml**                         | App entry/resources                                | WPF runtime, App.xaml.cs    |
| **App.xaml.cs**                      | App logic, output redirection                      | MainWindow.xaml.cs, Console |
| **MainWindow.xaml**                  | Main UI layout                                     | MainWindow.xaml.cs          |
| **MainWindow.xaml.cs**               | Main UI logic, hooks startup, event handling       | InputHooks, UdpMouseTransmitter |
| **Hooks\InputHooks.cs**              | Input hooks, event logging, UDP send               | MainWindow.xaml.cs, UdpMouseTransmitter |
| **Network\UdpMouseTransmitter.cs**   | UDP send/receive mouse data                        | InputHooks, MainWindow.xaml.cs |
| **AssemblyInfo.cs**                  | WPF resource management                            | WPF runtime                 |

### File Details

- **App.xaml / App.xaml.cs:**  
  Sets up the application, redirects all console output to the UI log.

- **MainWindow.xaml / MainWindow.xaml.cs:**  
  Provides the main user interface, handles user mode selection, starts input hooks and network logic, and displays all logs.

- **Hooks\InputHooks.cs:**  
  Installs system-wide hooks, logs input events, and sends mouse data over the network.

- **Network\UdpMouseTransmitter.cs:**  
  Handles UDP communication for sending and receiving mouse position data.

- **AssemblyInfo.cs:**  
  Ensures WPF resources are found and loaded correctly.

---

## Getting Started

### Prerequisites

- Windows 10/11
- [.NET 8 SDK](https://dotnet.microsoft.com/en-us/download/dotnet/8.0)
- Visual Studio 2022 or later (recommended)

### Build & Run

1. **Clone the repository:**

2. **Open in Visual Studio** and build the solution.

3. **Run the application.**

### Usage

- **Host Mode:**  
  Click **Host** to listen for incoming mouse data.

- **Cohost Mode:**  
  Enter the host's IP address and click **Cohost** to send your mouse position to the host.

- **Log Window:**  
  All input events and system messages will appear in the log window.

---

## Notes

- **Administrator Rights:**  
  Input hooks may require running the application as Administrator.
- **Network:**  
  Ensure UDP port 5000 is open on both machines.
- **Output Redirection:**  
  All `Console.WriteLine` output is shown in the UI, not in the terminal.

---

## Pruning & Maintenance

- **Safe to Delete:**  
  - `bin/`, `obj/`, and all `*.g.cs` files (generated by the build process).
  - Any unused or duplicate class/resource files.

- **Required:**  
  All files listed in the File Overview table above are necessary for the app's operation.

---

## License

[MIT](LICENSE) 

---

## Contributing

Pull requests and issues are welcome! Please open an issue for bugs or feature requests.

---

## Credits

- Built with .NET 8, WPF, and low-level Windows API hooks.
